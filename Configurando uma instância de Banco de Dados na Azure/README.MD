# Guia de Configura√ß√£o de Banco de Dados no Microsoft Azure

## üìã Objetivo

Este reposit√≥rio cont√©m um guia pr√°tico para configura√ß√£o de inst√¢ncias de Banco de Dados na plataforma Microsoft Azure, servindo como material de apoio para estudos e implementa√ß√µes futuras.

## üéØ P√∫blico-Alvo

- Desenvolvedores iniciantes em cloud computing
- Profissionais migrando para Azure
- Estudantes de tecnologia da informa√ß√£o
- Arquitetos de solu√ß√µes em forma√ß√£o

## üìö √çndice

1. [Introdu√ß√£o ao Azure Database](#introdu√ß√£o-ao-azure-database)
2. [Tipos de Banco de Dados Dispon√≠veis](#tipos-de-banco-de-dados-dispon√≠veis)
3. [Pr√©-requisitos](#pr√©-requisitos)
4. [Configura√ß√£o Passo a Passo](#configura√ß√£o-passo-a-passo)
5. [Configura√ß√µes de Seguran√ßa](#configura√ß√µes-de-seguran√ßa)
6. [Monitoramento e Performance](#monitoramento-e-performance)
7. [Backup e Recupera√ß√£o](#backup-e-recupera√ß√£o)
8. [Custos e Otimiza√ß√£o](#custos-e-otimiza√ß√£o)
9. [Dicas e Boas Pr√°ticas](#dicas-e-boas-pr√°ticas)
10. [Troubleshooting](#troubleshooting)
11. [Recursos Adicionais](#recursos-adicionais)

## üåü Introdu√ß√£o ao Azure Database

O Microsoft Azure oferece diversos servi√ßos de banco de dados gerenciados que eliminam a necessidade de configurar e manter a infraestrutura subjacente. Os principais benef√≠cios incluem:

- **Alta Disponibilidade**: SLA de at√© 99,99%
- **Escalabilidade Autom√°tica**: Ajuste de recursos conforme demanda
- **Seguran√ßa Integrada**: Criptografia, firewall e autentica√ß√£o
- **Backup Autom√°tico**: Prote√ß√£o contra perda de dados
- **Monitoramento**: Insights de performance em tempo real

## üóÑÔ∏è Tipos de Banco de Dados Dispon√≠veis

### SQL Database (PaaS)
- **Descri√ß√£o**: Banco de dados SQL Server totalmente gerenciado
- **Ideal para**: Aplica√ß√µes modernas que precisam de recursos SQL avan√ßados
- **Caracter√≠sticas**: Escalabilidade autom√°tica, intelig√™ncia integrada

### MySQL Database
- **Descri√ß√£o**: MySQL totalmente gerenciado
- **Ideal para**: Aplica√ß√µes web, e-commerce
- **Caracter√≠sticas**: Compatibilidade total com MySQL Community

### PostgreSQL Database
- **Descri√ß√£o**: PostgreSQL totalmente gerenciado
- **Ideal para**: Aplica√ß√µes que requerem recursos avan√ßados de banco relacional
- **Caracter√≠sticas**: Suporte a JSON, extens√µes personalizadas

### Cosmos DB
- **Descri√ß√£o**: Banco NoSQL multi-modelo
- **Ideal para**: Aplica√ß√µes globalmente distribu√≠das
- **Caracter√≠sticas**: Baixa lat√™ncia, m√∫ltiplos modelos de dados

### SQL Managed Instance
- **Descri√ß√£o**: SQL Server com compatibilidade quase 100%
- **Ideal para**: Migra√ß√£o lift-and-shift de SQL Server on-premises
- **Caracter√≠sticas**: Inst√¢ncia dedicada, recursos avan√ßados

## ‚ö° Pr√©-requisitos

### Conta Azure
- Conta ativa do Microsoft Azure
- Cr√©ditos dispon√≠veis ou assinatura v√°lida
- Permiss√µes adequadas (Contributor ou Owner role)

### Ferramentas Necess√°rias
- Navegador web atualizado
- Azure CLI (opcional)
- Azure PowerShell (opcional)
- Cliente de banco de dados (SQL Server Management Studio, MySQL Workbench, etc.)

### Conhecimentos B√°sicos
- Conceitos de banco de dados relacionais
- No√ß√µes b√°sicas de redes e seguran√ßa
- Fundamentos de cloud computing

## üîß Configura√ß√£o Passo a Passo

### Passo 1: Acessar o Portal Azure
1. Acesse [portal.azure.com](https://portal.azure.com)
2. Fa√ßa login com suas credenciais
3. No painel principal, clique em "Criar um recurso"

### Passo 2: Selecionar o Tipo de Banco
1. Na categoria "Bancos de dados", escolha o tipo desejado
2. Clique em "Criar" no servi√ßo selecionado
3. Selecione o modelo de implanta√ß√£o (se aplic√°vel)

### Passo 3: Configura√ß√µes B√°sicas
```
Assinatura: [Sua assinatura ativa]
Grupo de recursos: [Criar novo ou usar existente]
Nome do servidor: [nome-unico-servidor]
Regi√£o: [Regi√£o mais pr√≥xima dos usu√°rios]
M√©todo de autentica√ß√£o: [SQL Authentication ou Azure AD]
Login do administrador: [nome-admin]
Senha: [senha-forte-12-caracteres]
```

### Passo 4: Configura√ß√µes de Compute e Storage
```
N√≠vel de servi√ßo: 
- Basic: Para desenvolvimento e teste
- Standard: Para cargas de trabalho pequenas a m√©dias
- Premium: Para cargas de trabalho cr√≠ticas

Tamanho do compute: [Baseado na necessidade]
Armazenamento: [GB necess√°rios]
Backup: [Per√≠odo de reten√ß√£o]
```

### Passo 5: Configura√ß√µes de Rede
```
Conectividade: 
- Endpoint p√∫blico: Acesso via internet
- Endpoint privado: Acesso apenas via VNet

Regras de firewall:
- Permitir acesso de servi√ßos Azure: Sim/N√£o
- Adicionar IP do cliente atual: Sim/N√£o
- Regras personalizadas: [IPs espec√≠ficos]
```

### Passo 6: Configura√ß√µes Adicionais
```
Origem dos dados:
- Banco vazio
- Exemplo (AdventureWorks)
- Backup existente

Agrupamento: SQL_Latin1_General_CP1_CI_AS (padr√£o)
Prote√ß√£o Avan√ßada contra Amea√ßas: Habilitado
```

### Passo 7: Revis√£o e Cria√ß√£o
1. Revise todas as configura√ß√µes
2. Verifique estimativa de custos
3. Clique em "Criar"
4. Aguarde a implanta√ß√£o (5-10 minutos)

## üîí Configura√ß√µes de Seguran√ßa

### Firewall do Servidor
```sql
-- Configurar regras de firewall via T-SQL
EXEC sp_set_firewall_rule 
    @name = 'AllowMyIP', 
    @start_ip_address = '192.168.1.1', 
    @end_ip_address = '192.168.1.1';
```

### Transparent Data Encryption (TDE)
- **Habilitado por padr√£o** em SQL Database
- Criptografia autom√°tica dos dados em repouso
- Chaves gerenciadas pelo servi√ßo ou pelo cliente

### Always Encrypted
```sql
-- Exemplo de configura√ß√£o Always Encrypted
CREATE COLUMN MASTER KEY [CMK1]
WITH (
    KEY_STORE_PROVIDER_NAME = 'AZURE_KEY_VAULT',
    KEY_PATH = 'https://myvault.vault.azure.net/keys/mykey/key-id'
);
```

### Azure Active Directory Integration
```powershell
# Configurar admin do Azure AD
Set-AzSqlServerActiveDirectoryAdministrator 
    -ResourceGroupName "myResourceGroup" 
    -ServerName "myServer" 
    -DisplayName "DBA Group"
```

## üìä Monitoramento e Performance

### M√©tricas Importantes
- **DTU/vCore Utilization**: Uso de recursos de compute
- **Storage Usage**: Espa√ßo em disco utilizado
- **Connection Count**: N√∫mero de conex√µes ativas
- **Deadlocks**: Travamentos de transa√ß√µes
- **Query Performance**: Tempo de resposta das consultas

### Query Performance Insight
1. Acesse o recurso no portal Azure
2. Navegue para "Query Performance Insight"
3. Analise as consultas mais demoradas
4. Implemente otimiza√ß√µes sugeridas

### Alertas Personalizados
```json
{
    "name": "High DTU Usage",
    "description": "Alert when DTU usage exceeds 80%",
    "condition": {
        "metric": "dtu_consumption_percent",
        "operator": "GreaterThan",
        "threshold": 80
    },
    "action": {
        "type": "email",
        "recipients": ["admin@company.com"]
    }
}
```

## üíæ Backup e Recupera√ß√£o

### Backup Autom√°tico
- **Backup completo**: Semanal
- **Backup diferencial**: A cada 12-24 horas
- **Backup de log de transa√ß√µes**: A cada 5-10 minutos
- **Reten√ß√£o**: 7-35 dias (configur√°vel)

### Restaura√ß√£o Point-in-Time
```powershell
# Restaurar banco para um ponto espec√≠fico no tempo
Restore-AzSqlDatabase 
    -FromPointInTimeBackup 
    -PointInTime "2024-01-15T10:30:00Z" 
    -ResourceGroupName "myResourceGroup" 
    -ServerName "myServer" 
    -TargetDatabaseName "myDatabase-restored" 
    -ResourceId "/subscriptions/.../databases/myDatabase"
```

### Geo-Replication
```sql
-- Configurar replica secund√°ria
ALTER DATABASE [myDatabase] 
ADD SECONDARY ON SERVER [secondary-server] 
WITH (ALLOW_CONNECTIONS = ALL);
```

## üí∞ Custos e Otimiza√ß√£o

### Modelos de Pre√ßos

#### DTU Model
- **Basic**: R$ 15-50/m√™s
- **Standard**: R$ 50-500/m√™s  
- **Premium**: R$ 500-3000/m√™s

#### vCore Model
- **General Purpose**: R$ 200-1000/m√™s
- **Business Critical**: R$ 800-4000/m√™s
- **Hyperscale**: Vari√°vel conforme uso

### Dicas de Otimiza√ß√£o de Custos
1. **Right-sizing**: Monitore uso e ajuste recursos
2. **Reserved Instances**: Economize at√© 55% com reservas
3. **Pause/Resume**: Para ambientes de desenvolvimento
4. **Elastic Pools**: Compartilhe recursos entre bancos
5. **Cleanup**: Remova recursos n√£o utilizados

### Calculadora de Custos
Use a [Calculadora de Pre√ßos do Azure](https://azure.microsoft.com/pricing/calculator/) para estimar custos antes da implementa√ß√£o.

## üí° Dicas e Boas Pr√°ticas

### Nomenclatura
```
Conven√ß√£o sugerida:
- Servidor: srv-[projeto]-[ambiente]-[regi√£o]
- Banco: db-[aplicacao]-[ambiente]
- Exemplo: srv-ecommerce-prod-eastus
```

### Performance
1. **Indexa√ß√£o adequada**: Monitore missing indexes
2. **Estat√≠sticas atualizadas**: Configure auto-update
3. **Query tuning**: Use Query Store para an√°lise
4. **Connection pooling**: Configure no lado da aplica√ß√£o

### Seguran√ßa
1. **Princ√≠pio do menor privil√©gio**: Conceda apenas permiss√µes necess√°rias
2. **Rota√ß√£o de senhas**: Implemente pol√≠tica de rota√ß√£o
3. **Auditoria**: Habilite logging de atividades cr√≠ticas
4. **Network isolation**: Use Private Endpoints quando poss√≠vel

### Desenvolvimento
```sql
-- Template para cria√ß√£o de usu√°rio com permiss√µes limitadas
CREATE USER [app-user] WITH PASSWORD = 'StrongPassword123!';
ALTER ROLE db_datareader ADD MEMBER [app-user];
ALTER ROLE db_datawriter ADD MEMBER [app-user];
```

## üîß Troubleshooting

### Problemas Comuns

#### Erro de Conex√£o
```
Erro: "Cannot connect to server"
Solu√ß√µes:
1. Verificar regras de firewall
2. Confirmar string de conex√£o
3. Testar conectividade de rede
4. Validar credenciais
```

#### Performance Lenta
```
Sintomas: Queries demoradas, timeouts
Diagn√≥stico:
1. Verificar DTU/vCore usage
2. Analisar Query Performance Insight  
3. Revisar planos de execu√ß√£o
4. Verificar bloqueios
```

#### Limite de Storage
```
Erro: "Database size limit reached"
Solu√ß√µes:
1. Aumentar tier de servi√ßo
2. Limpar dados desnecess√°rios
3. Arquivar dados hist√≥ricos
4. Implementar particionamento
```

### Comandos √öteis de Diagn√≥stico
```sql
-- Verificar uso de espa√ßo
SELECT 
    DB_NAME() AS DatabaseName,
    CAST(SUM(size) * 8.0 / 1024 AS DECIMAL(10,2)) AS SizeMB
FROM sys.database_files;

-- Identificar queries demoradas
SELECT TOP 10 
    total_worker_time/execution_count AS avg_cpu_time,
    execution_count,
    SUBSTRING(st.text, (qs.statement_start_offset/2)+1,
    ((CASE qs.statement_end_offset
        WHEN -1 THEN DATALENGTH(st.text)
        ELSE qs.statement_end_offset
    END - qs.statement_start_offset)/2) + 1) AS statement_text
FROM sys.dm_exec_query_stats AS qs
CROSS APPLY sys.dm_exec_sql_text(qs.sql_handle) AS st
ORDER BY avg_cpu_time DESC;
```

## üìö Recursos Adicionais

### Documenta√ß√£o Oficial
- [Azure SQL Database Documentation](https://docs.microsoft.com/azure/sql-database/)
- [Azure Database for MySQL](https://docs.microsoft.com/azure/mysql/)
- [Azure Database for PostgreSQL](https://docs.microsoft.com/azure/postgresql/)
- [Azure Cosmos DB](https://docs.microsoft.com/azure/cosmos-db/)

### Ferramentas √öteis
- **Azure Data Studio**: Cliente multiplataforma
- **SQL Server Management Studio**: Cliente Windows completo
- **Azure CLI**: Automa√ß√£o via linha de comando
- **Azure PowerShell**: Scripts de gerenciamento
- **Terraform**: Infrastructure as Code
- **ARM Templates**: Deployment templates

### Cursos e Certifica√ß√µes
- **AZ-900**: Azure Fundamentals
- **DP-900**: Azure Data Fundamentals  
- **AZ-104**: Azure Administrator
- **DP-300**: Azure Database Administrator

### Comunidade
- [Microsoft Q&A](https://docs.microsoft.com/answers/)
- [Stack Overflow - Azure](https://stackoverflow.com/questions/tagged/azure)
- [Reddit - r/AZURE](https://reddit.com/r/AZURE)
- [Azure Blog](https://azure.microsoft.com/blog/)

## ü§ù Contribui√ß√µes

Este reposit√≥rio √© um material de estudo colaborativo. Contribui√ß√µes s√£o bem-vindas atrav√©s de:

1. **Issues**: Reporte problemas ou sugest√µes
2. **Pull Requests**: Propose melhorias no conte√∫do
3. **Discuss√µes**: Compartilhe experi√™ncias e dicas
4. **Exemplos**: Adicione casos de uso reais

### Como Contribuir
1. Fork este reposit√≥rio
2. Crie uma branch para sua feature (`git checkout -b feature/nova-secao`)
3. Commit suas mudan√ßas (`git commit -am 'Adiciona nova se√ß√£o sobre X'`)
4. Push para a branch (`git push origin feature/nova-secao`)
5. Abra um Pull Request

## üìÑ Licen√ßa

Este projeto est√° sob a licen√ßa MIT. Veja o arquivo [LICENSE](LICENSE) para mais detalhes.

## üìû Suporte

Para quest√µes espec√≠ficas sobre este guia:
- Abra uma [issue](../../issues) no reposit√≥rio
- Entre em contato atrav√©s das [discuss√µes](../../discussions)

Para suporte oficial do Azure:
- [Azure Support Plans](https://azure.microsoft.com/support/plans/)
- [Azure Documentation](https://docs.microsoft.com/azure/)

---

**‚≠ê Se este guia foi √∫til, considere dar uma estrela no reposit√≥rio!**

*√öltima atualiza√ß√£o: Maio 2024*